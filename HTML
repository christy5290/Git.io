<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>エアコンコンサルツール</title>
  <link rel="stylesheet" href="style.css"> 
</head>
<body>
  <div class="container">
    <div class="card">
      <div id="question">エアコンコンサルを始めますか？</div>
      <button id="startBtn" class="btn btn-start" onclick="start()">スタート</button>
      <button id="yesBtn" class="btn btn-yes" onclick="answer('yes')" style="display:none;">はい</button>
      <button id="noBtn" class="btn btn-no" onclick="answer('no')" style="display:none;">いいえ</button>
      <button id="restartBtn" class="btn btn-restart" onclick="restart()" style="display:none;">もう一度</button>
    </div>
  </div>

  <script>
    const questions = [
      { key: 'inpei', question: '隠蔽配管？' },
      { key: 'airClean', question: '空気清浄は必要？' },
      { key: 'eco', question: '電気代を抑えたい？' },
      { key: 'autoClean', question: 'エアコンの掃除を二週間に一回する？' },
      { key: 'smell', question: '臭いを抑えたい？' },
      { key: 'rakuClean', question: 'ダストボックスの掃除を楽にしたい？' },
      { key: 'kasitsu', question: '加湿機能は必要？'},
      { key: 'windmove', question: '同じ部屋に暑がりさん、寒がりさんがいる？'},
      { key: 'nagamochi', question: '10年以上使いたい？'},
      { key: 'onsei', question: '音声機能は欲しい？'},
      { key: 'kabi', question: 'カビを抑えたい？'},
      { key: 'nowind', question: 'エアコンの風が嫌い？'},
      { key: 'smart', question: 'コンパクトな見た目がいい？'}
    ];

    const products = [
      // 
    ];

    let answers = {};
    let currentIndex = 0;

    function start() {
      currentIndex = 0;
      answers = {};
      document.getElementById('startBtn').style.display = 'none';
      document.getElementById('yesBtn').style.display = 'inline-block';
      document.getElementById('noBtn').style.display = 'inline-block';
      document.getElementById('restartBtn').style.display = 'none';
      document.getElementById('question').innerText = questions[currentIndex].question;
    }

    function answer(choice) {
      const key = questions[currentIndex].key;
      answers[key] = choice;
      currentIndex++;

      if (currentIndex >= questions.length) {
        showResult();
      } else {
        document.getElementById('question').innerText = questions[currentIndex].question;
      }
    }

    function showResult() {
      let currentProducts = [...products];

      if (answers['inpei'] === 'yes') {
        const allowedNamesForInpeiYes = ['日立 WNシリーズ', 'ダイキン Cシリーズ', 'ダイキン Eシリーズ', '富士通 Wシリーズ', '富士通 Lシリーズ'];
        currentProducts = currentProducts.filter(product =>
          product.conditions.inpei === 'yes' &&
          allowedNamesForInpeiYes.includes(product.name)
        );
      }

      const scored = currentProducts.map(product => {
        let matchCount = 0;
        let relevantConditionsCount = 0;

        for (const [key, value] of Object.entries(product.conditions)) {
          if (answers.hasOwnProperty(key)) {
            relevantConditionsCount++;
            if (answers[key] === value) {
              matchCount++;
            }
          }
        }

        const score = relevantConditionsCount > 0 ? matchCount / relevantConditionsCount : 0;
        return { ...product, score };
      });

      const sorted = scored.sort((a, b) => b.score - a.score);

      const resultDiv = document.getElementById('question');
      if (sorted.length > 0 && sorted[0].score > 0) {
        const topProducts = sorted.slice(0, 3);
        resultDiv.innerHTML = `<div class="result"><strong>おすすめ製品（マッチ度順）:</strong><br>${topProducts.map(p => `${p.name}（${Math.round(p.score * 100)}%）`).join('<br>')}</div>`;
      } else {
        resultDiv.innerHTML = '<div class="result">ご希望条件に近い製品が見つかりませんでした。</div>';
      }

      document.getElementById('yesBtn').style.display = 'none';
      document.getElementById('noBtn').style.display = 'none';
      document.getElementById('restartBtn').style.display = 'inline-block';
    }

    function restart() {
      document.getElementById('startBtn').style.display = 'inline-block';
      document.getElementById('yesBtn').style.display = 'none';
      document.getElementById('noBtn').style.display = 'none';
      document.getElementById('restartBtn').style.display = 'none';
      document.getElementById('question').innerText = 'エアコンコンサルを始めますか？';
    }
  </script>
</body>
</html>
